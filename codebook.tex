% =============================================================
% Codebook 主檔說明
% - 目標：在最少頁數內排入常用演算法 / 資料結構程式碼。
% - 版面：使用 twocolumn 壓縮，手動設定窄邊界，字體縮小。
% - 編譯：建議使用 xelatex (需支援 fontspec / xeCJK)。
% - 可調整項目：行號 (listings)、字型、是否加入更多章節。
% =============================================================
\documentclass[a4paper,10pt,twocolumn,oneside]{article}
\setlength{\columnsep}{10pt}                                                              %兩欄模式的間距
\setlength{\columnseprule}{0pt}                                                                %兩欄模式間格線粗細

\usepackage{amsthm}								%定義，例題
\usepackage{amssymb}
%\usepackage[margin=2cm]{geometry}
\usepackage{fontspec}								%設定字體
\usepackage{color}
\usepackage[x11names]{xcolor}
\usepackage{listings}								%顯示code用的
%\usepackage[Glenn]{fncychap}						%排版，頁面模板
\usepackage{fancyhdr}								%設定頁首頁尾
\usepackage{graphicx}								%Graphic
\usepackage{enumerate}
\usepackage{titlesec}
\usepackage{amsmath}
\usepackage{tikz}
\usepackage{xpatch}
\usepackage[CheckSingle, CJKmath]{xeCJK}
% \usepackage{CJKulem}
%\usepackage[T1]{fontenc}
\titlespacing{\section}{0cm}{0cm}{0cm}
\titlespacing{\subsection}{0cm}{0cm}{0cm}
\usepackage{amsmath, courier, listings, fancyhdr, graphicx}
\topmargin=0pt
\headsep=5pt
\textheight=780pt
\footskip=0pt
\voffset=-40pt
\textwidth=545pt
\marginparsep=0pt
\marginparwidth=0pt
\marginparpush=0pt
\oddsidemargin=0pt
\evensidemargin=0pt
\hoffset=-42pt

%\renewcommand\listfigurename{圖目錄}
%\renewcommand\listtablename{表目錄} 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\setmainfont [				%主要字型
    Path = .fonts/ttf/,
    UprightFont = *-Regular,
    BoldFont = *-Bold,
    ItalicFont = *-Italic
  ] {Consolas}

\setmonofont [        
    Path = .fonts/ttf/,
    UprightFont = *-Regular
  ] {Monaco}

% \setmainfont{TeX Gyre Termes}
% \setmainfont{Consolas}				%主要字型
% \setmonofont{Monaco}				%主要字型
\setCJKmainfont[
  Path = .fonts/ttf/,        % 你放字型檔的資料夾（相對於主 .tex 檔案）
  Extension = .ttf,
  UprightFont = *-Regular,
  BoldFont = *-Bold,
]{NotoSansTC}

% \setCJKmainfont{Consolas}			%中文字型
% \setmainfont{sourcecodepro}
\XeTeXlinebreaklocale "zh"						%中文自動換行
\XeTeXlinebreakskip = 0pt plus 1pt				%設定段落之間的距離
\setcounter{secnumdepth}{3}						%目錄顯示第三層

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\makeatletter
\lst@CCPutMacro\lst@ProcessOther {"2D}{\lst@ttfamily{-{}}{-{}}}
\@empty\z@\@empty
\makeatother
\lstset{											% Code顯示
language=C++,										% the language of the code
basicstyle=\footnotesize\ttfamily, 						% the size of the fonts that are used for the code
%numbers=left,										% where to put the line-numbers
numberstyle=\footnotesize,						% the size of the fonts that are used for the line-numbers
stepnumber=1,										% the step between two line-numbers. If it's 1, each line  will be numbered
numbersep=5pt,										% how far the line-numbers are from the code
backgroundcolor=\color{white},					% choose the background color. You must add \usepackage{color}
showspaces=false,									% show spaces adding particular underscores
showstringspaces=false,							% underline spaces within strings
showtabs=false,									% show tabs within strings adding particular underscores
frame=false,											% adds a frame around the code
tabsize=2,											% sets default tabsize to 2 spaces
captionpos=b,										% sets the caption-position to bottom
breaklines=true,									% sets automatic line breaking
breakatwhitespace=false,							% sets if automatic breaks should only happen at whitespace
escapeinside={\%*}{*)},							% if you want to add a comment within your code
morekeywords={*},									% if you want to add more keywords to the set
keywordstyle=\bfseries\color{Blue1},
commentstyle=\itshape\color{Red4},
stringstyle=\itshape\color{Green4},
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}
\pagestyle{fancy}
\fancyfoot{}
%\fancyfoot[R]{\includegraphics[width=20pt]{ironwood.jpg}}
\fancyhead[L]{NTOU Miaotomata}
\fancyhead[R]{\thepage}
\renewcommand{\headrulewidth}{0.4pt}
\renewcommand{\contentsname}{Contents} 

\newcommand{\includetex}[2]{
  \subsection{#1}
  \input{#2}
  \vspace{-1.2em}
}
\scriptsize
\tableofcontents

% \newpage
%sectionstart  % ===== 以下依分類匯入各程式碼檔案 =====
\section{basic}
    \subsection{default}
    \lstinputlisting{basic/default.cpp}

    \subsection{godcode}
    \lstinputlisting{basic/godcode.cpp}

    \subsection{random}
    \lstinputlisting{basic/random.cpp}

    \subsection{run.bat}
    \lstinputlisting{basic/run.bat}

    \subsection{run.sh}
    \lstinputlisting{basic/run.sh}

\section{binarysearch}
    \subsection{二分搜}
    \lstinputlisting{binarysearch/二分搜.cpp}

    \subsection{三分搜}
    \lstinputlisting{binarysearch/三分搜.cpp}

\section{dataStructure}
    \subsection{DSU}
    \lstinputlisting{dataStructure/DSU.cpp}

    \subsection{fenwickTree}
    \lstinputlisting{dataStructure/fenwickTree.cpp}

    \subsection{segmentTree1}
    \lstinputlisting{dataStructure/new_segtree單點.cpp}

    \subsection{segmentTree2}
    \lstinputlisting{dataStructure/new_segtree_range.cpp}
    
    \subsection{persistantSegTree}
    \lstinputlisting{dataStructure/persistantSegTree.cpp}
    
    \subsection{countMinimumSeg} 
    \lstinputlisting{dataStructure/countMinimumSeg.cpp}

    \subsection{LiChaoSegTree}
    \lstinputlisting{dataStructure/LiChaoSegTree.cpp}

    \subsection{2Dbit}
    \lstinputlisting{dataStructure/2Dbit.cpp}


\section{dp}
    \subsection{digit}
    \lstinputlisting{dp/digit.cpp}

    \subsection{p\_median}
    \lstinputlisting{dp/p_median.cpp}

    \subsection{sosdp}
    \lstinputlisting{dp/sos_dp.cpp}

    \subsection{MinimumSteinerTree}
    \lstinputlisting{dp/MinimumSteinerTree.cpp}

    \subsection{lowConvexHull}
    \lstinputlisting{dp/lowConvexHull.cpp}

\section{flow}
    \subsection{Dinic}
    \lstinputlisting{flow/Dinic.cpp}

    \subsection{isap}
    \lstinputlisting{flow/isap.cpp}

    \subsection{KM}
    \lstinputlisting{flow/KM.cpp}

    \subsection{匈牙利}
    \lstinputlisting{flow/hungarian.cpp}

    \subsection{對偶建圖}
    \lstinputlisting{flow/對偶建圖.cpp}

    \subsection{最小花費最大流dijkstra 不能負值}
    \lstinputlisting{flow/最小花費最大流dijkstra 不能負值.cpp}

    \subsection{最小花費最大流SPFA}
    \lstinputlisting{flow/最小花費最大流SPFA.cpp}

\section{geometry}
    \subsection{Point}
    \lstinputlisting{geometry/Point.cpp}

    \subsection{Line}
    \lstinputlisting{geometry/Line.cpp}

    \subsection{Circle}
    \lstinputlisting{geometry/Circle.cpp}

    \subsection{圓多邊形面積}
    \lstinputlisting{geometry/AreaOfCirclePolygon.cpp}

    \subsection{圓三角形面積}
    \lstinputlisting{geometry/AreaOfCircleTriangle.cpp}

    \subsection{半平面交}
    \lstinputlisting{geometry/HalfPlaneIntersection.cpp}

    \subsection{圓線交}
    \lstinputlisting{geometry/IntersectionOfCircleLine.cpp}

    \subsection{圓圓交}
    \lstinputlisting{geometry/IntersectionOfCircles.cpp}

    \subsection{線線交}
    \lstinputlisting{geometry/IntersectionOfLines.cpp}

    \subsection{ConvexHull}
    \lstinputlisting{geometry/ConvexHull.cpp}

    \subsection{Hulltrick}
    \lstinputlisting{geometry/ConvexHulltrick.cpp}

    \subsection{點線距}
    \lstinputlisting{geometry/PointToSegmentDistance.cpp}

    \subsection{MEC}
    \lstinputlisting{geometry/MinimalEnclosingCircle.cpp}

    \subsection{MEC2}
    \lstinputlisting{geometry_backup/MEC.cpp}

    \subsection{旋轉卡尺}
    \lstinputlisting{geometry/RotatingCalipers.cpp}
    
    \subsection{Minkowski}
    \lstinputlisting{geometry/Minkowski.cpp}

    \subsection{PointInPolygon}
    \lstinputlisting{geometry/PointInPolygon.cpp}

    \subsection{UnionOfCircles}
    \lstinputlisting{geometry/UnionOfCircles.cpp}

    \subsection{UnionOfPolygons}
    \lstinputlisting{geometry/UnionOfPolygons.cpp}

    \subsection{圓公切線}
    \lstinputlisting{geometry/TangentLinesOfCircles.cpp}

    \subsection{點圓切線}
    \lstinputlisting{geometry/TangentLinesOfCirclePoint.cpp}

    \subsection{最近點對}
    \lstinputlisting{geometry/ClosestPair.cpp}
\section{graph}
    \subsection{BCC}
    \lstinputlisting{graph/BCC.cpp}

    \subsection{SCC}
    \lstinputlisting{graph/SCC.cpp}

    \subsection{支配樹}
    \lstinputlisting{graph/支配樹.cpp}

    \subsection{最大團}
    \lstinputlisting{graph/最大團.cpp}

    \subsection{最小圈}
    \lstinputlisting{graph/最小圈.cpp}

    \subsection{kShortestPath}
    \lstinputlisting{graph/kShortestPath_O(knlogn).cpp}

    \includetex{結論}{graph/conclusion.tex} % 圖論補充 / 結論整理
\section{math}
    \subsection{DiscreteSqrt}
    \lstinputlisting{math/DiscreteSqrt.cpp}

    \subsection{excrt}
    \lstinputlisting{math/excrt.cpp}

    \subsection{exgcd}
    \lstinputlisting{math/exgcd.cpp}

    \subsection{FFT}
    \lstinputlisting{math/FFT.cpp}

    \subsection{josephus}
    \lstinputlisting{math/josephus.cpp}

    \includetex{Theorem}{math/theorem.tex}  % 數學常用定理彙整
    \vspace{1.2em}
    \includetex{Primes}{math/Primes.tex}    % 質數相關補充內容
    \vspace{1.2em}
    \subsection{millerrabin}
    \lstinputlisting{math/miller_rabin.cpp}

    \subsection{phi}
    \lstinputlisting{math/phi.cpp}

    \subsection{pollardrho}
    \lstinputlisting{math/pollard_rho.cpp}

    \subsection{primes}
    \lstinputlisting{math/primes.cpp}

    \subsection{Euler}
    \lstinputlisting{math/euler.cpp}

    \subsection{quickeuler}
    \lstinputlisting{math/quick_euler.cpp}

    \subsection{sieve}
    \lstinputlisting{math/sieve.cpp}

    \subsection{NTT}
    \lstinputlisting{math/NTT.cpp}

\section{polynomial}
    \subsection{Definition}
    \lstinputlisting{polynomial/poly.cpp}
    
    \subsection{Inverse Series}
    \lstinputlisting{polynomial/inverse_series.cpp}

    \subsection{Poly Shift}
    \lstinputlisting{polynomial/poly_shift.cpp}

    \subsection{Exponential}
    \lstinputlisting{polynomial/exponential.cpp}

    \subsection{Nature log}
    \lstinputlisting{polynomial/log.cpp}

\section{other}
    \subsection{cdq}
    \lstinputlisting{other/cdq.cpp}

    \subsection{DeBruijnSequence}
    \lstinputlisting{other/DeBruijnSequence.cpp}

    \subsection{SmallestLexicographic}
    \lstinputlisting{other/SmallestLexicographic.cpp}

\section{random}
    \subsection{XORShift}
    \lstinputlisting{random/XORShift(1-1).cpp}

\section{string}
    \subsection{KMP}
    \lstinputlisting{string/KMP.cpp}

    \subsection{minRotation}
    \lstinputlisting{string/minRotation.cpp}

    \subsection{PalindromeTree}
    \lstinputlisting{string/PalindromeTree.cpp}

    \subsection{RollingHash}
    \lstinputlisting{string/RollingHash.cpp}

    \subsection{SuffixArray}
    \lstinputlisting{string/SuffixArray.cpp}

    \subsection{trie}
    \lstinputlisting{string/trie.cpp}

    \subsection{Z-algorithm}
    \lstinputlisting{string/Z-algorithm.cpp}

    \subsection{馬拉車}
    \lstinputlisting{string/馬拉車.cpp}

\section{tree}
    \subsection{DSUONTREE}
    \lstinputlisting{tree/DSUONTREE.cpp}

    \subsection{EularTour}
    \lstinputlisting{tree/Eular_Tour.cpp}

    \subsection{LCA}
    \lstinputlisting{tree/LCA.cpp}

    \subsection{treehash}
    \lstinputlisting{tree/treehash.cpp}

    \subsection{HeavyLightDecomposition}
    \lstinputlisting{tree/HeavyLightDecomposition.cpp}

    \subsection{VirtualTree}
    \lstinputlisting{tree/VirtualTree.cpp}
%sectionend  % ===== 程式碼主體結束 =====


% 方格紙 (下方巨集)：列印時可附加數頁空白格紙供賽中手寫推導。
% 若不需要可註解整段，或改為插入外部 PDF 模板以加速編譯。
% 方格紙
\newcommand{\halfgridpage}{
    \begin{tikzpicture}[every node/.style={minimum size=1cm-\pgflinewidth, outer sep=10pt}, scale=2]
        \draw[step=0.2cm,color=gray] (0,0) grid (4,13);
        \draw[step=1cm,color=black,line width=0.4mm] (0,0) grid (4,13);
    \end{tikzpicture}
    \newpage
}
\newcommand{\gridpage}{
    \centering
\begin{tikzpicture}[every node/.style={minimum size=1cm-\pgflinewidth, outer sep=10pt}, scale=2]
    \draw[step=0.2cm,color=gray] (0,0) grid (9,12);
    \draw[step=1cm,color=black,line width=0.4mm] (0,0) grid (9,12);
\end{tikzpicture}
    \newpage
}
\onecolumn
\gridpage
\gridpage
\gridpage
\gridpage
\gridpage


\end{document}
